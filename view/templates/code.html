{% extends 'view.html' %}
{% block title %}
{% endblock %}

{% block style %}
<style>
  .editor-container {
    max-width: 960px;
    margin: 40px auto;
    background-color: #1a1f2b;
    padding: 30px;
    border-radius: 12px;
    color: #fff;
  }

  .editor-title {
    margin-bottom: 20px;
    color: #58a6ff;
  }

  .editor-wrapper {
    display: flex;
    position: relative;
  }

  .line-numbers {
    padding: 10px;
    background-color: #161b22;
    color: #8b949e;
    text-align: right;
    user-select: none;
    font-family: monospace;
    font-size: 14px;
    border-right: 1px solid #333;
  }

  .line-numbers span {
    display: block;
    height: 18px;
  }

  textarea.code-editor {
    width: 100%;
    height: 400px;
    font-family: monospace;
    font-size: 14px;
    background-color: #0d1117;
    color: #d6e1ff;
    border: 1px solid #333;
    padding: 10px;
    border-radius: 0 8px 8px 0;
    resize: none;
    overflow: auto;
  }

  .editor-actions {
    margin-top: 20px;
    display: flex;
    gap: 10px;
  }

  .btn-save {
    background-color: #28a745;
    color: #fff;
  }

  .btn-save:hover {
    background-color: #218838;
  }

  .btn-phantom {
    background-color: #007bff;
    color: #fff;
  }

  .btn-phantom:hover {
    background-color: #0069d9;
  }
</style>
{% endblock %}

{% block menus %}
<nav class="sidebar sidebar-offcanvas" id="sidebar">
  <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
    <a class="sidebar-brand brand-logo" href="/dashboard">SpecterPanel</a>
    <a class="sidebar-brand brand-logo-mini" href="/dashboard">SP</a>
  </div>
  <ul class="nav">
    <li class="nav-item nav-category">
      <span class="nav-link">Menu Options</span>
    </li>
    <li class="nav-item menu-items">
      <a class="nav-link" href="/dashboard">
        <span class="menu-icon"><i class="mdi mdi-view-dashboard"></i></span>
        <span class="menu-title">Dashboard</span>
      </a>
    </li>
    <li class="nav-item menu-items">
      <a class="nav-link" href="/api_link">
        <span class="menu-icon"><i class="mdi mdi-webhook"></i></span>
        <span class="menu-title">Api Link</span>
      </a>
    </li>
    <li class="nav-item menu-items">
      <a class="nav-link" href="/fishing">
        <span class="menu-icon"><i class="mdi mdi-fish"></i></span>
        <span class="menu-title">Fishing</span>
      </a>
    </li>
    <li class="nav-item menu-items">
      <a class="nav-link" href="/hooking">
        <span class="menu-icon"><i class="mdi mdi-hook"></i></span>
        <span class="menu-title">Hooking</span>
      </a>
    </li>
    <li class="nav-item menu-items">
      <a class="nav-link" href="/code">
        <span class="menu-icon"><i class="mdi mdi-code-braces"></i></span>
        <span class="menu-title">Code ground</span>
      </a>
    </li>
  </ul>
</nav>
{% endblock %}

{% block body %}
<div class="container editor-container">
  <h2 class="editor-title">Code Editor Panel</h2>
  <form method="POST" action="#">
    <div class="editor-wrapper">
      <div class="line-numbers" id="lineNumbers"></div>
      <textarea id="codeEditor" name="code" class="code-editor" placeholder="# Write your script or extension code here..."></textarea>
    </div>
    <div class="editor-actions">
      <button type="submit" name="type" value="botnet" class="btn btn-save">Save as Botnet Script</button>
      <button type="submit" name="type" value="phantom" class="btn btn-phantom">Save as PhantomGate Extension</button>
    </div>
  </form>
</div>

<script>
  const textarea = document.getElementById('codeEditor');
  const lineNumbers = document.getElementById('lineNumbers');

  function updateLineNumbers() {
    const lines = textarea.value.split('\n').length;
    lineNumbers.innerHTML = Array.from({ length: lines }, (_, i) => `<span>${i + 1}</span>`).join('');
  }

  textarea.addEventListener('input', updateLineNumbers);
  textarea.addEventListener('scroll', () => {
    lineNumbers.scrollTop = textarea.scrollTop;
  });

  // Initialize line numbers
  updateLineNumbers();
</script>
{% endblock %}